常用工具
======================================

Vim用法
^^^^^^^^^^^^^^^

常用命令
::::::::::::::
设置折叠
###############
::

    set foldmethod=indent
    set fdm=indent

- ``manual``           手工定义折叠
- ``indent``           更多的缩进表示更高级别的折叠
- ``expr``             用表达式来定义折叠
- ``syntax``           用语法高亮来定义折叠
- ``diff``             对没有更改的文本进行折叠
- ``marker``           对文中的标志折叠


设置tab为四个空格
###################
::

    set ts=4
    set noexpandtab
    %retab!

使用标签页
###################
- 使用标签页打开多个文件 ::

    vim -p [fileName1] [fileName2] ...

- 启动标签页： ::

    :tabe[dit]
    :tabnew [fileName]

- 切换标签页 ::

    :tabn[ext]、:tabN[ext]、:tabp[revious]
    :tabn[ext] {count}
    gt、gT
    :tabfir[st]、:tabl[ast]

- 列出所有标签页 ::

    :tabs

- 关闭标签页 ::

    :tabc[lose][!]  关闭当前标签页
    :tabc[lose][!]  {count} 关闭第N个标签页。
    :tabo[nly][!]   关闭其他标签页。


查找
##########
-   在所有行中查找 字符串 出现的次数 ::

        :%s/字符串/&/gn

-   在m和n行之间查找 字符串 出现的次数 ::

        :m,ns/字符串/&/gn

替换
##################################################
在命令最后加c，则表示每次替换前需要手动确认

-   替换当前行第一个 vivian 为 sky ::

        :s/vivian/sky/

-   替换当前行所有 vivian 为 sky ::

        :s/vivian/sky/g
        :s/vivian/sky/gc

-   替换每一行的第一个 vivian 为 sky ::

        :%s/vivian/sky/

-   替换每一行中所有 vivian 为 sky ::

        :%s/vivian/sky/g
        :%s/vivian/sky/gc

-   替换第 n 行开始到最后一行中每一行的第一个 vivian 为 sky (n 为数字，若 n 为 .，表示从当前行开始到最后一行) ::

        :n,$s/vivian/sky/

-   替换第 n 行开始到最后一行中每一行所有 vivian 为 sky (n 为数字，若 n 为 .，表示从当前行开始到最后一行) ::

        :n,$s/vivian/sky/g
        :n,$s/vivian/sky/gc

-   让首字母大写 ::

        :%s/^[a-z]/\U&/gc

快捷命令
##############
-   将选中范围内的字母变为小写 `gu` ，变为大写 `gU`

相关的系统命令
######################
-   `lsof -c  vim` 看看vim都打开了哪些文件。

无法选中文字
########################
-   ``set mouse=v``

Git用法
^^^^^^^^^^^^^^^^^^^^^

Git代理的设置方法
:::::::::::::::::::::
设置： ::

    git config --local https.proxy http://127.0.0.1:1080
    git config --local http.proxy 'socks5://127.0.0.1:1080'

解除： ::

    git config --global --unset https.proxy

集成vimdiff
:::::::::::::::::::::
::

    git config --global diff.tool vimdiff
    git config --global difftool.prompt false
    git config --global alias.d difftool

中文问题
:::::::::::::::::::::
解决 ``git status`` 不能显示中文的问题。 ::

    git config --global core.quotepath false

生成公钥
:::::::::::::::::::::
::

    git config --global user.name "username"
    git config --global user.email "user@email"
    ssh-keygen -t rsa -C “user@email”

更新远程分支列表
:::::::::::::::::::::
::

    git remote update origin --prune

查看log
:::::::::::::::::::::
查看2017-03-10以后，用户名的提交 ::

    git log --after=2017-03-10 --author=[name]

使用vimdiff进行git merge
::::::::::::::::::::::::::::::::
- 左上角的窗口是你本人的当前分支。编号为2
- 右上角的窗口是与当前分支冲突的远程分支（被merge的分支）。编号为4
- 中上的窗口是Base。编号为3
- 下面的窗口是自动merge的结果。编号为1
- 使用命令 `:diffget [num]` 可快速merge。

Eclilpse
^^^^^^^^^^^^^^^^^^^^^^^^^

快捷键
::::::::::::::::

=================== ===========================================
快捷键              作用
=================== ===========================================
Ctrl+PgUp           显示一已打开的文件列表(Show List)
Ctrl+Shift+F        格式化页面
=================== ===========================================

技巧备忘
:::::::::::::::::
properties文件不能显示中文
  `菜单` -> `Preferences` -> `General` -> `ContentTypes` -> `Text` -> `Java Properties File` ，设置 `Default encoding` ，把下面的 `ISO-8859-1` 改为 `UTF-8` 或者 `GBK` （推荐 `UTF-8` ），然后Update

MySql备忘
^^^^^^^^^^^^^^^^^^^^^^

常用命令
:::::::::::::::
修改数据
########################
::

    UPDATE table_name SET field1=new-value1, field2=new-value2 [WHERE Clause]

重置主键：
#########################
::

    ALTER TABLE table_name AUTO_INCREMENT= 1;

查询表的数据量
#########################
表：information_schema.tables，它存储了各个表的统计信息。 ::

    select table_schema, table_name, table_rows, data_length, index_length from information_schema.tables order by table_rows desc;
    select table_schema, table_name, table_rows, data_length, index_length from information_schema.tables where table_schema = 'sp_etl' order by table_rows desc;

查询表的结构
#########################
::

    desc sp_etl.creative_audience_network;

包括字段注释 ::

    show create table tablename;

查询表的索引
#########################
::

    show index from sp_etl.creative_audience_network;

查询各语句的执行时间：
#########################
::

    show processlist

查询各IP的连接数：
#########################
::

    select count(*) as num
    from (
        select SUBSTR(host, 1, INSTR(host, ':') - 1) as ip, db , command, info
        from  information_schema.processlist
    ) as a;

    select ip, count(*) as num
    from (
        select SUBSTR(host, 1, INSTR(host, ':') - 1) as ip, db , command, info
        from  information_schema.processlist
    ) as a
    group by ip order by num desc;

创建数据库
#########################
::

    create database if not exists dbname character SET latin1 collate latin1_bin;
    create database if not exists dbname DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

更改数据库字符编码集
#########################
::

    ALTER DATABASE db_name DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci

创建用户
#########################
::

    CREATE USER 'username'@'localhost' IDENTIFIED BY 'passwd';

赋予用户权限
#########################
::

    GRANT ALL ON dbname.* TO 'username'@'localhost';

查看所有用户
#########################
查看MYSQL数据库中所有用户 ::

    SELECT DISTINCT CONCAT('User: ''',user,'''@''',host,''';') AS query FROM mysql.user;

查看用户权限
#########################
查看数据库中具体某个用户的权限 ::

    show grants for 'cactiuser'@'%';

添加联合唯一约束
#########################
::

    --修改表时
    ALTER TABLE tabelName ADD UNIQUE KEY(col1, col2);
    --创建表时
    UNIQUE KEY `keyname` (`col1`,`col2`)

修改用户密码
#########################
::

    use mysql;
    update user set password=password('新密码') where user='root';
    flush privileges;

忘记管理员密码
#########################
-   在my.ini的[mysqld]字段下面加入： ``skip-grant-tables``
-   重启mysql服务，这时的mysql不需要密码即可登录数据库
-   然后进入mysql: ::

        use mysql;
        update user set password=password('新密码') where user='root';
        flush privileges

性能优化语句：
#########################
::

    select table_name, data_length/1000000, index_length/1000000 from information_schema.tables where table_schema = 'sp_etl' and table_name like 'creative%' order by data_length desc, index_length desc;
    select * from information_schema.processlist  where INFO like '%creative_audience_network%' order by TIME;

保留字
:::::::::
-   字段名不可用词：

    -   key
    -   desc

-   字段名可用词:

    -   id
    -   path

Apache
^^^^^^^^^^^^^^^^^^^
不同端口不同项目的配置
#########################
文件： ``/etc/httpd/conf/httpd.conf`` ::

    Listen 9988
    NameVirtualHost *:9988
    <VirtualHost *:9988>
        ServerName 192.168.199.168:9988
        # ServerName 127.0.0.1:9988
        DocumentRoot [web path]
        <Directory "[web path]">
            Options Indexes FollowSymLinks
            AllowOverride All
            Order Deny,Allow
            Allow from all
        </Directory>
    </VirtualHost>

其他

Yii2
^^^^^^^^^^^^^^^^^^^^
查看组建的版本
####################
通过文件 ``[yii2-home]/composer.lock`` 查看

tmux
^^^^^^^^^^^^^^^^^^^
快捷键
#############
+-------------+------------+-------------------------------------------------------------------------------------+
| Ctrl+b                   | 激活控制台；此时以下按键生效                                                        |
+=============+============+=====================================================================================+
|    系统     |     ?      |  列出所有快捷键；按q返回                                                            |
+    操作     +------------+-------------------------------------------------------------------------------------+
|             |     d      |  脱离当前会话；这样可以暂时返回Shell界面，输入tmux attach能够重新进入之前的会话     |
+             +------------+-------------------------------------------------------------------------------------+
|             |   Ctrl+b   |  激活控制台；此时以下按键生效                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     D      |  选择要脱离的会话；在同时开启了多个会话时使用                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |   Ctrl+z   |  挂起当前会话                                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     r      |  强制重绘未脱离的会话                                                               |
+             +------------+-------------------------------------------------------------------------------------+
|             |     s      |  选择并切换会话；在同时开启了多个会话时使用                                         |
+             +------------+-------------------------------------------------------------------------------------+
|             |     :      |  进入命令行模式；此时可以输入支持的命令，例如kill-server可以关闭服务器              |
+             +------------+-------------------------------------------------------------------------------------+
|             |     [      |  进入复制模式；此时的操作与vi/emacs相同，按q/Esc退出                                |
+             +------------+-------------------------------------------------------------------------------------+
|             |     ~      |  列出提示信息缓存；其中包含了之前tmux返回的各种提示信息                             |
+-------------+------------+-------------------------------------------------------------------------------------+
|  窗口操作   |     c      |  创建新窗口                                                                         |
+             +------------+-------------------------------------------------------------------------------------+
|             |     &      |  关闭当前窗口                                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     数字键 |  切换至指定窗口                                                                     |
+             +------------+-------------------------------------------------------------------------------------+
|             |     p      |  切换至上一窗口                                                                     |
+             +------------+-------------------------------------------------------------------------------------+
|             |     n      |  切换至下一窗口                                                                     |
+             +------------+-------------------------------------------------------------------------------------+
|             |     l      |  在前后两个窗口间互相切换                                                           |
+             +------------+-------------------------------------------------------------------------------------+
|             |     w      |  通过窗口列表切换窗口                                                               |
+             +------------+-------------------------------------------------------------------------------------+
|             |     ,      |  重命名当前窗口；这样便于识别                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     .      |  修改当前窗口编号；相当于窗口重新排序                                               |
+             +------------+-------------------------------------------------------------------------------------+
|             |     f      |  在所有窗口中查找指定文本                                                           |
+-------------+------------+-------------------------------------------------------------------------------------+
|  面板操作   |     "      |  将当前面板平分为上下两块                                                           |
+             +------------+-------------------------------------------------------------------------------------+
|             |     %      |  将当前面板平分为左右两块                                                           |
+             +------------+-------------------------------------------------------------------------------------+
|             |     x      |  关闭当前面板                                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     !      |  将当前面板置于新窗口；即新建一个窗口，其中仅包含当前面板                           |
+             +------------+-------------------------------------------------------------------------------------+
|             | Ctrl+方向键|  以1个单元格为单位移动边缘以调整当前面板大小                                        |
+             +------------+-------------------------------------------------------------------------------------+
|             | Alt+方向键 |  以5个单元格为单位移动边缘以调整当前面板大小                                        |
+             +------------+-------------------------------------------------------------------------------------+
|             |   Space    |  在预置的面板布局中循环切换；依次包括                                               |
|             |            |  even-horizontal、even-vertical、main-horizontal、main-vertical、tiled              |
+             +------------+-------------------------------------------------------------------------------------+
|             |     q      |  显示面板编号                                                                       |
+             +------------+-------------------------------------------------------------------------------------+
|             |     o      |  在当前窗口中选择下一面板                                                           |
+             +------------+-------------------------------------------------------------------------------------+
|             |   方向键   |  移动光标以选择面板                                                                 |
+             +------------+-------------------------------------------------------------------------------------+
|             |     {      |  向前置换当前面板                                                                   |
+             +------------+-------------------------------------------------------------------------------------+
|             |     }      |  向后置换当前面板                                                                   |
+             +------------+-------------------------------------------------------------------------------------+
|             |   Alt+o    |  逆时针旋转当前窗口的面板                                                           |
+             +------------+-------------------------------------------------------------------------------------+
|             |   Ctrl+o   |  顺时针旋转当前窗口的面板                                                           |
+-------------+------------+-------------------------------------------------------------------------------------+
